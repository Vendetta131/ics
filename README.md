commit from Denis


commit from Knysh
commit from Liuda


commit from knysh for rebase
